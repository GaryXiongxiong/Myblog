<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 快速搭建易于打理的个人博客 - 基于Github Pages与Actions的博客自动部署 · 蒋亦雄的博客</title><meta name="description" content="快速搭建易于打理的个人博客 - 基于Github Pages与Actions的博客自动部署 - Yixiong Jiang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://jiangyixiong.top/atom.xml" title="蒋亦雄的博客"><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="蒋亦雄的博客" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/categories/blog" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/categories/podcast" target="_self" class="nav-list-link">PODCAST</a></li><li class="nav-list-item"><a href="https://github.com/GaryXiongxiong" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/resume/" target="_self" class="nav-list-link">RESUME</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">快速搭建易于打理的个人博客 - 基于Github Pages与Actions的博客自动部署</h1><div class="post-info">2021年1月25日</div><div class="post-content"><p>Hexo是一款快速，简洁且高效的博客框架。可以快速地将Markdown格式文章转化为静态博客页面。Hexo本身附带一键部署功能，可将生成的静态页面部署至GitHub pages，但本文讨论的是另一种部署方式。通过Github Actions在提交博客源码时自动生成静态页面并部署至Github Pages。</p>
<span id="more"></span>

<h2 id="Github-Pages"><a href="#Github-Pages" class="headerlink" title="Github Pages"></a>Github Pages</h2><blockquote>
<p>Github Pages 被设计用以发布存储于Github仓库的个人、组织、项目相关的静态页面。</p>
</blockquote>
<p>Github Pages 的配置非常方便，我们只需将静态页面上传至一个Github仓库，并在仓库配置中开启GithubPages相关选项</p>
<p><img src="/images/image-20210126104911097.png" alt="image-20210126104911097"></p>
<p>其中在<strong>Source</strong>部分中配置静态页面所在的分支与目录。设置完成后即可通过{UserName}.github.io访问。这里也可以使用自定义域名，详细配置见<a target="_blank" rel="noopener" href="https://docs.github.com/articles/using-a-custom-domain-with-github-pages/">Github官方指南</a>。</p>
<h2 id="Github-Actions"><a href="#Github-Actions" class="headerlink" title="Github Actions"></a>Github Actions</h2><blockquote>
<p>Github Actions是Github推出的自动构建、测试、部署的工作流。类似于Gitlab的CI/CD或Jenkins。可以通过Github的pull、merge、issue等动作触发。</p>
</blockquote>
<p>有了Github Pages，我们只需要将Hexo生成的静态页面推送至我们配置了Github Pages对应的仓库即可。如果我们采用手动操作，有如下几个步骤：</p>
<ol>
<li>本地安装Hexo并初始化我们的博客（仅需一次）</li>
<li>写点什么</li>
<li>通过NPM+Hexo生成静态页面</li>
<li>将静态页面所在文件夹init为一个git文件夹，并关联到我们创建好的Github仓库，并推送</li>
</ol>
<p>而采用Github Actions，我们仅需将这几个动作写成脚本，自动化即可。</p>
<h4 id="初始化本地Hexo博客"><a href="#初始化本地Hexo博客" class="headerlink" title="初始化本地Hexo博客"></a>初始化本地Hexo博客</h4><p>这部分不详细说明Hexo的使用，可见<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo官方指南</a>，非常详细且有中文。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm install -g hexo-cli</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hexo init &lt;目录名&gt;</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> &lt;目录名&gt;</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm install</span></span><br></pre></td></tr></table></figure>

<p>之后我们可以添加几篇初始内容。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hexo new <span class="string">&quot;文章标题&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hexo new page --path about/me <span class="string">&quot;页面标题&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>之后，我们本地运行Hexo查看下效果。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hexo server</span></span><br></pre></td></tr></table></figure>

<p>至此，我们已经在本地完成了Hexo的初始化。之后将其推送至一个新的Github仓库，作为源码仓库。</p>
<h4 id="配置Actions自动部署"><a href="#配置Actions自动部署" class="headerlink" title="配置Actions自动部署"></a>配置Actions自动部署</h4><p>重点来了，之后我们要配置Github Actions，让源码仓库在有新的push内容时，自动生成静态页面，并将静态页面推送至Github Pages仓库。</p>
<p>首先，为了让Actions拥有向Pages仓库push内容的权限，我们需要在我们的Github账号中新建一个Personal Access Token。前往个人Settings - Developer settings - Personal access token。并创建一个新的Token。</p>
<p><img src="/images/image-20210126111006651.png" alt="image-20210126111006651"></p>
<p><img src="/images/image-20210126111142998.png" alt="image-20210126111142998"></p>
<p>之后，我们需要将这个新创建的token添加至博客源码仓库。前往源码仓库的设置页面：Settings-Secret, 添加一个新的 repository secret。</p>
<p><img src="/images/image-20210126111338255.png" alt="image-20210126111338255"> </p>
<p>完成之后我们就可以开始编写Actions脚本了。添加Action的方法为，在源码仓库中，新建 <code>.github/workflows</code>目录。并在其中创建一个<code>yml</code>文件，文件名可自由定义。这个<code>yml</code>文件就是自动构建的脚本，具体的编写可见<a target="_blank" rel="noopener" href="https://docs.github.com/en/actions/learn-github-actions">Github官方指南</a>。这里放出本博客的构建脚本并进行说明：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Garys</span> <span class="string">blog</span> <span class="string">deployment</span> <span class="comment">#自动构建工作流名称</span></span><br><span class="line"><span class="attr">on:</span> </span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;master&quot;</span> </span><br><span class="line">      <span class="comment">#触发器，详见https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#onpushpull_requestpaths</span></span><br><span class="line"><span class="attr">jobs:</span> <span class="comment"># 构建任务列表，一个工作流中可有多个构建任务</span></span><br><span class="line">  <span class="attr">generate_public:</span> <span class="comment"># 构建任务1</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">generate</span> <span class="string">&amp;</span> <span class="string">deploy</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span> <span class="comment"># 定义运行环境，这里选择ubuntu</span></span><br><span class="line">    <span class="attr">steps:</span> <span class="comment"># 任务步骤列表，本任务中有4项任务</span></span><br><span class="line">    </span><br><span class="line">      <span class="comment"># 1. 将本仓库代码拉至当前工作目录，这里使用了Github提供的预定义Action，可在 https://github.com/actions/checkout 查看其源码，本质上是通过git拉取当前仓库指定分支的代码。</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2.3.1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">persist-credentials:</span> <span class="literal">false</span></span><br><span class="line">          </span><br><span class="line">      <span class="comment"># 2. 通过npm安装项目依赖，这里直接通过run运行npm命令</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm install</span></span><br><span class="line"><span class="string"></span>          </span><br><span class="line">      <span class="comment"># 3. 通过npm生成hexo静态页面</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Generate</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm run-script build</span></span><br><span class="line"><span class="string"></span>          </span><br><span class="line">      <span class="comment"># 4. 将生成的静态页面目录推送至Github pages仓库。这里使用了Github pages部署action，源码与文档见 https://github.com/JamesIves/github-pages-deploy-action ，其通过Git将指定目录推送至指定仓库。</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@3.7.1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">GITHUB_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.BLOG_DEPLOYMENT</span> <span class="string">&#125;&#125;</span> <span class="comment"># 刚才配置的Repository secret，secrets后的名称与刚才配置的名称一致。</span></span><br><span class="line">          <span class="attr">BRANCH:</span> <span class="string">master</span> <span class="comment"># 目标分支</span></span><br><span class="line">          <span class="attr">FOLDER:</span> <span class="string">public</span> <span class="comment"># 静态页面所在当前残酷的目录</span></span><br><span class="line">          <span class="attr">REPOSITORY_NAME:</span> <span class="string">GaryXiongxiong/Myblog</span> <span class="comment"># 目标仓库</span></span><br><span class="line">          <span class="attr">GIT_CONFIG_NAME:</span> <span class="string">GaryXiongxiong</span></span><br><span class="line">          <span class="attr">GIT_CONFIG_EMAIL:</span> <span class="string">i@jiangyixiong.top</span></span><br><span class="line">          <span class="attr">CLEAN:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>配置完成后，只需把我们更新后的源码仓库推送至Github，之后便可在Github仓库页面的Actions标签中查看构建日志：</p>
<p><img src="/images/image-20210126113749255.png" alt="image-20210126113749255"></p>
<p>构建成功后，我们便可通过我们Github pages的链接查看更新后的博客啦！</p>
</div></article></div></main><footer><div class="paginator"><a href="/2021/01/28/LeetCode%E7%AC%94%E8%AE%B0-%E7%94%A8%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E8%A7%A3%E5%86%B3%E3%80%90120-%E4%B8%89%E8%A7%92%E5%BD%A2%E6%9C%80%E5%B0%8F%E8%B7%AF%E5%BE%84%E5%92%8C%E3%80%91/" class="prev">PREV</a><a href="/2021/01/25/Hear%E4%B8%8D%E5%90%8CS01E07%E4%B8%89%E5%8D%81%E8%80%8C%E5%B7%B2%EF%BC%8C%E8%B6%8A%E6%9D%A5%E8%B6%8A%E5%A4%9A%E6%88%91%E8%AE%A4%E8%AF%86%E7%9A%84%E4%BA%BA%E9%80%89%E6%8B%A9%E5%8E%BB%E5%8D%96%E4%BF%9D%E9%99%A9%E4%BA%86/" class="next">NEXT</a></div><div class="copyright"><p><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv">页面访问量:<span id="busuanzi_value_page_pv"></span></span></p><p>© 2018 - 2025 <a href="http://jiangyixiong.top">Yixiong Jiang</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>